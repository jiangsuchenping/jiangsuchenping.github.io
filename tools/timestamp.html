<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>时间戳转换工具 - 在线工具箱</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .tool-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .converter {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .converter-panel {
            flex: 1;
            min-width: 300px;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .converter-panel h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .input-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .button-group {
            margin: 20px 0;
        }
        
        .button-group button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin-right: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .button-group button:hover {
            background-color: #2980b9;
        }
        
        .result {
            margin-top: 15px;
            padding: 10px;
            background-color: #e8f4fc;
            border-radius: 4px;
            min-height: 20px;
        }
        
        .error {
            color: #e74c3c;
            background-color: #fdf2f2;
            border: 1px solid #f5c6cb;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>时间戳转换工具</h1>
            <p>Unix时间戳与日期时间相互转换工具</p>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul>
                <li><a href="../index.html">首页</a></li>
                <li><a href="#timestamp-to-date">时间戳转日期</a></li>
                <li><a href="#date-to-timestamp">日期转时间戳</a></li>
            </ul>
        </div>
    </nav>

    <main class="tool-container">
        <div class="converter">
            <div class="converter-panel">
                <h3>时间戳转日期时间</h3>
                <div class="input-group">
                    <label for="timestamp-input">Unix时间戳：</label>
                    <input type="text" id="timestamp-input" placeholder="请输入Unix时间戳">
                </div>
                <div class="button-group">
                    <button onclick="timestampToDate()">转换为日期</button>
                    <button onclick="getCurrentTimestamp()">获取当前时间戳</button>
                </div>
                <div class="result" id="timestamp-result"></div>
            </div>
            
            <div class="converter-panel">
                <h3>日期时间转时间戳</h3>
                <div class="input-group">
                    <label for="date-input">日期时间：</label>
                    <input type="text" id="date-input" placeholder="格式: YYYY-MM-DD HH:mm:ss">
                </div>
                <div class="button-group">
                    <button onclick="dateToTimestamp()">转换为时间戳</button>
                    <button onclick="getCurrentDate()">获取当前日期</button>
                </div>
                <div class="result" id="date-result"></div>
            </div>
        </div>
        
        <div class="info">
            <h3>说明</h3>
            <ul>
                <li>Unix时间戳是从1970年1月1日（UTC/GMT的午夜）开始所经过的秒数，不包括闰秒</li>
                <li>JavaScript中使用毫秒作为时间戳单位，如果输入秒级时间戳会自动转换</li>
                <li>日期时间格式：YYYY-MM-DD HH:mm:ss</li>
            </ul>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 在线工具箱 - 时间戳转换工具</p>
        </div>
    </footer>

    <script>
        function timestampToDate() {
            const timestampInput = document.getElementById('timestamp-input').value;
            const resultElement = document.getElementById('timestamp-result');
            
            if (!timestampInput.trim()) {
                resultElement.innerHTML = '<div class="error">请输入时间戳</div>';
                return;
            }
            
            try {
                let timestamp = parseInt(timestampInput);
                
                // 如果是秒级时间戳，转换为毫秒级
                if (timestamp < 10000000000) {
                    timestamp *= 1000;
                }
                
                const date = new Date(timestamp);
                
                if (isNaN(date.getTime())) {
                    throw new Error('无效的时间戳');
                }
                
                const formattedDate = formatDate(date);
                resultElement.innerHTML = `
                    <p><strong>UTC时间：</strong> ${date.toUTCString()}</p>
                    <p><strong>本地时间：</strong> ${formattedDate}</p>
                    <p><strong>ISO 8601：</strong> ${date.toISOString()}</p>
                `;
                
                // 记录工具使用频次
                if (typeof recordToolUsage === 'function') {
                    recordToolUsage('时间戳转换', window.location.href);
                }
            } catch (error) {
                resultElement.innerHTML = `<div class="error">转换错误: ${error.message}</div>`;
            }
        }
        
        function dateToTimestamp() {
            const dateInput = document.getElementById('date-input').value;
            const resultElement = document.getElementById('date-result');
            
            if (!dateInput.trim()) {
                resultElement.innerHTML = '<div class="error">请输入日期时间</div>';
                return;
            }
            
            try {
                const date = new Date(dateInput);
                
                if (isNaN(date.getTime())) {
                    throw new Error('无效的日期格式');
                }
                
                const timestamp = Math.floor(date.getTime() / 1000);
                resultElement.innerHTML = `
                    <p><strong>Unix时间戳：</strong> ${timestamp}</p>
                    <p><strong>毫秒时间戳：</strong> ${date.getTime()}</p>
                `;
                
                // 记录工具使用频次
                if (typeof recordToolUsage === 'function') {
                    recordToolUsage('时间戳转换', window.location.href);
                }
            } catch (error) {
                resultElement.innerHTML = `<div class="error">转换错误: ${error.message}</div>`;
            }
        }
        
        function getCurrentTimestamp() {
            const now = new Date();
            const timestamp = Math.floor(now.getTime() / 1000);
            document.getElementById('timestamp-input').value = timestamp;
            timestampToDate();
        }
        
        function getCurrentDate() {
            const now = new Date();
            document.getElementById('date-input').value = formatDate(now);
            dateToTimestamp();
        }
        
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }
        
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            console.log('时间戳转换工具已加载');
            
            // 为按钮添加事件监听器以记录使用频次
            document.getElementById('timestamp-input').addEventListener('input', function() {
                if (typeof recordToolUsage === 'function') {
                    recordToolUsage('时间戳转换', window.location.href);
                }
            });
            
            document.getElementById('date-input').addEventListener('input', function() {
                if (typeof recordToolUsage === 'function') {
                    recordToolUsage('时间戳转换', window.location.href);
                }
            });
        });
    </script>
</body>
</html>