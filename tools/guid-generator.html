<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUID生成器 - 在线工具箱</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .tool-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .result-group {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            text-align: center;
        }
        
        #guid-results {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            word-break: break-all;
            margin: 10px 0;
        }
        
        .guid-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 8px 0;
        }
        
        .guid-text {
            flex-grow: 1;
            text-align: left;
            padding-right: 10px;
        }
        
        .options-group {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .option {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .option select, .option input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .button-group {
            margin: 20px 0;
            text-align: center;
        }
        
        .button-group button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .button-group button:hover {
            background-color: #2980b9;
        }
        
        .copy-btn {
            background-color: #28a745 !important;
        }
        
        .copy-btn:hover {
            background-color: #218838 !important;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>GUID生成器</h1>
            <p>在线生成GUID/UUID</p>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul>
                <li><a href="../index.html">首页</a></li>
                <li><a href="#generate">生成</a></li>
            </ul>
        </div>
    </nav>

    <main class="tool-container">
        <div class="info">
            <h3>关于GUID</h3>
            <p>GUID（Globally Unique Identifier，全局唯一标识符）是一种由算法生成的唯一标识符。GUID通常用于分布式系统中，确保不同设备生成的标识符不会冲突。</p>
        </div>
        
        <div class="options-group">
            <div class="option">
                <label for="guid-format">格式：</label>
                <select id="guid-format">
                    <option value="standard">标准格式 (带连字符)</option>
                    <option value="nohyphens">无连字符</option>
                    <option value="braces">带大括号</option>
                    <option value="hex">十六进制字符串</option>
                </select>
            </div>
            <div class="option">
                <label for="guid-count">数量：</label>
                <input type="number" id="guid-count" min="1" max="50" value="5">
            </div>
        </div>

        <div class="button-group">
            <button onclick="generateGUIDs()">生成GUID</button>
            <button class="copy-btn" onclick="copyAllToClipboard()">复制所有</button>
        </div>

        <div class="result-group">
            <h3>生成结果</h3>
            <div id="guid-results"></div>
        </div>

        <div class="info">
            <h3>说明</h3>
            <ul>
                <li>每次点击"生成GUID"按钮都会生成一个新的唯一标识符</li>
                <li>生成的GUID遵循标准的8-4-4-4-12格式（32个十六进制字符）</li>
                <li>可以使用"复制到剪贴板"按钮快速复制生成的GUID</li>
            </ul>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 在线工具箱 - GUID生成器</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
    <script>
        // 工具ID，用于保存选项
        const TOOL_ID = 'guid-generator';
        
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 加载上次的选项设置
            const count = getOption(TOOL_ID, 'guid-count', 5);
            const format = getOption(TOOL_ID, 'guid-format', 'standard');
            
            document.getElementById('guid-count').value = count;
            document.getElementById('guid-format').value = format;
            
            // 自动生成GUID
            generateGUIDs();
        });
        
        /**
         * 生成单个GUID/UUID (版本4 - 随机)
         * @returns {string} 未格式化的GUID字符串
         */
        function formatGuidWithHyphens() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
        
        /**
         * 生成十六进制格式的GUID
         * @returns {string} 十六进制格式的GUID
         */
        function formatGuidAsHex() {
            const guid = formatGuidWithHyphens().replace(/-/g, '');
            return '0x' + guid;
        }
        
        /**
         * 生成多个GUID并显示在页面上
         */
        function generateGUIDs() {
            const count = parseInt(document.getElementById('guid-count').value);
            const format = document.getElementById('guid-format').value;
            const resultContainer = document.getElementById('guid-results');
            resultContainer.innerHTML = '';
            
            // 保存选项设置
            saveOption(TOOL_ID, 'guid-count', count);
            saveOption(TOOL_ID, 'guid-format', format);
            
            // 记录使用频次
            recordToolUsage('GUID生成器', window.location.href);
            
            for (let i = 0; i < count; i++) {
                let guid = '';
                if (format === 'standard') {
                    guid = formatGuidWithHyphens();
                } else if (format === 'nohyphens') {
                    guid = formatGuidWithHyphens().replace(/-/g, '');
                } else if (format === 'braces') {
                    guid = '{' + formatGuidWithHyphens() + '}';
                } else if (format === 'hex') {
                    guid = formatGuidAsHex();
                }
                
                const resultItem = document.createElement('div');
                resultItem.className = 'guid-result';
                resultItem.innerHTML = `
                    <div class="guid-text">${guid}</div>
                    <button class="copy-btn" onclick="copyToClipboard('${guid}')">复制</button>
                `;
                
                resultContainer.appendChild(resultItem);
            }
        }

        /**
         * 复制指定的GUID到剪贴板
         * @param {string} text 要复制的GUID文本
         */
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('GUID已复制到剪贴板: ' + text);
            }).catch(err => {
                console.error('复制失败: ', err);
                // 降级方案
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('GUID已复制到剪贴板: ' + text);
            });
        }
        
        /**
         * 复制所有生成的GUID到剪贴板
         */
        function copyAllToClipboard() {
            const resultElements = document.querySelectorAll('.guid-text');
            if (resultElements.length === 0) {
                alert('请先生成GUID');
                return;
            }
            
            const allGuids = Array.from(resultElements).map(el => el.textContent).join('\n');
            
            navigator.clipboard.writeText(allGuids).then(() => {
                alert('所有GUID已复制到剪贴板');
            }).catch(err => {
                console.error('复制失败: ', err);
                // 降级方案
                const textArea = document.createElement('textarea');
                textArea.value = allGuids;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('所有GUID已复制到剪贴板');
            });
         }
      </script>
</body>
</html>