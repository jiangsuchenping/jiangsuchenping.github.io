<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高级数学训练 - 幼儿数学练习工具</title>
    <meta name="description" content="专为幼儿设计的高级数学训练工具，包含30以内加减法、50以内加减法和乘法口诀训练，帮助孩子轻松掌握基础数学运算。">
    <meta name="keywords" content="幼儿数学,加减法练习,乘法口诀,数学训练,儿童教育">
    <meta name="author" content="jiangsuchenping">
    <meta property="og:title" content="高级数学训练 - 幼儿数学练习工具">
    <meta property="og:description" content="专为幼儿设计的高级数学训练工具，包含30以内加减法、50以内加减法和乘法口诀训练，帮助孩子轻松掌握基础数学运算。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jiangsuchenping.github.io/youeryuan/math-advanced-training.html">
    <meta property="og:image" content="https://jiangsuchenping.github.io/youeryuan/math-training-preview.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="高级数学训练 - 幼儿数学练习工具">
    <meta name="twitter:description" content="专为幼儿设计的高级数学训练工具，包含30以内加减法、50以内加减法和乘法口诀训练，帮助孩子轻松掌握基础数学运算。">
    <meta name="twitter:image" content="https://jiangsuchenping.github.io/youeryuan/math-training-preview.png">
    <!-- 预连接关键CDN域名 -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    
    <!-- 关键CSS资源预加载 -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- 备用CSS加载 -->
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"></noscript>
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"></noscript>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }
        
        .main-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin: 20px auto;
            max-width: 800px;
            padding: 30px;
        }
        
        .question-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 15px;
            padding: 40px;
            margin: 20px 0;
            text-align: center;
            font-size: 2.5rem;
            font-weight: bold;
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.3);
        }
        
        .answer-btn {
            font-size: 1.5rem;
            padding: 20px;
            margin: 10px;
            border-radius: 15px;
            border: none;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        .answer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .answer-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .correct {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%) !important;
            color: white;
        }
        
        .incorrect {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%) !important;
            color: white;
        }
        
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .progress-ring {
            width: 120px;
            height: 120px;
            margin: 0 auto;
        }
        
        .daily-limit {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .question-option {
            background: white;
            color: #333;
            font-size: 1.8rem;
            font-weight: bold;
            width: 80px;
            height: 80px;
            line-height: 80px;
            border-radius: 50%;
            margin: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .question-option:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .question-option.selected {
            background: #4e73df;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(78, 115, 223, 0.3);
        }
        
        .result-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            display: block;
        }
        
        .question-display {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            display: inline-block;
            min-width: 200px;
        }
        
        .question-display h4 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .nav-tabs .nav-link {
            border: none;
            color: #6c757d;
            font-weight: 600;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
        }
        
        .nav-tabs .nav-link:hover {
            color: #4e73df;
            background-color: rgba(78, 115, 223, 0.1);
        }
        
        .nav-tabs .nav-link.active {
            color: #4e73df;
            background-color: white;
            border-bottom: 3px solid #4e73df;
        }
        
        .nav-tabs .nav-link i {
            margin-right: 8px;
        }
        
        .tab-content {
            background: white;
            border-radius: 0 0 10px 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .history-summary {
            border-left: 4px solid #4e73df;
        }
        
        @media (max-width: 768px) {
            .question-option {
                width: 60px;
                height: 60px;
                line-height: 60px;
                font-size: 1.5rem;
                margin: 5px;
            }
            
            .question-display h4 {
                font-size: 2rem;
            }
        }
        
        /* 乘法表样式 */
        .multiplication-table {
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .multiplication-table table {
            border-collapse: collapse;
            width: 100%;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .multiplication-table th, .multiplication-table td {
            border: 1px solid #e0e0e0;
            padding: 12px;
            text-align: center;
            font-weight: bold;
        }
        
        .multiplication-table th {
            background: #4e73df;
            color: white;
        }
        
        .multiplication-table tr:nth-child(even) {
            background-color: #f8f9fc;
        }
        
        .multiplication-table td:hover {
            background-color: #e8f4ff;
            cursor: pointer;
        }
        
        .multiplication-table .highlight {
            background-color: #ffe8a1;
        }
        
        .multiplication-table .selected {
            background-color: #4e73df;
            color: white;
        }
    </style>
</head>
<body>
    <div id="app" class="container py-4">
        <div class="main-container">
            <h1 class="text-center mb-4">高级数学训练</h1>
            
            <!-- 导航标签 -->
            <ul class="nav nav-tabs" id="mathTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="math30-tab" data-bs-toggle="tab" data-bs-target="#math30" 
                            type="button" role="tab" aria-controls="math30" aria-selected="true"
                            @click="activeTab = 'math30'">
                        <i class="bi bi-plus-slash-minus"></i> 30以内加减法
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="math50-tab" data-bs-toggle="tab" data-bs-target="#math50" 
                            type="button" role="tab" aria-controls="math50" aria-selected="false"
                            @click="activeTab = 'math50'">
                        <i class="bi bi-plus-slash-minus"></i> 50以内加减法
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="multiplication-tab" data-bs-toggle="tab" data-bs-target="#multiplication" 
                            type="button" role="tab" aria-controls="multiplication" aria-selected="false"
                            @click="activeTab = 'multiplication'">
                        <i class="bi bi-x-lg"></i> 乘法口诀
                    </button>
                </li>
            </ul>
            
            <!-- 标签内容 -->
            <div class="tab-content" id="mathTabsContent">
                <!-- 30以内加减法 -->
                <div class="tab-pane fade show active" id="math30" role="tabpanel" aria-labelledby="math30-tab">
                    <h3 class="mt-3">30以内加减法训练</h3>
                    
                    <!-- 练习区域 -->
                    <div class="practice-area">
                        <div class="text-center my-4">
                            <div class="question-card">
                                <span v-if="math30.currentQuestion">{{ math30.currentQuestion.text }}</span>
                                <span v-else>准备开始...</span>
                            </div>
                            
                            <div class="mt-4" v-if="math30.currentQuestion && !math30.showingResult">
                                <button v-for="option in math30.currentQuestion.options" :key="option"
                                        class="answer-btn btn btn-light"
                                        :disabled="math30.selectedAnswer !== null"
                                        @click="selectAnswer('math30', option)">
                                    {{ option }}
                                </button>
                            </div>
                            
                            <div class="mt-4" v-if="math30.showingResult">
                                <div v-if="math30.isCorrect" class="text-success">
                                    <i class="bi bi-check-circle-fill result-icon"></i>
                                    <h4>答对了！真棒！</h4>
                                </div>
                                <div v-else class="text-danger">
                                    <i class="bi bi-x-circle-fill result-icon"></i>
                                    <h4>再试试看哦！正确答案是 {{ math30.currentQuestion.answer }}</h4>
                                </div>
                                
                                <button class="btn btn-primary mt-3" @click="nextQuestion('math30')">
                                    下一题 <i class="bi bi-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 统计卡片 -->
                    <div class="stats-section mt-5">
                        <h4 class="mb-3">
                            <i class="bi bi-calendar-day"></i> 今日练习统计
                            <small class="text-muted ms-2">{{ getCurrentDateString() }}</small>
                        </h4>
                        <div class="row">
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center">
                                        <h5>总题数</h5>
                                        <h3>{{ math30.stats.totalQuestions }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center">
                                        <h5>答对</h5>
                                        <h3>{{ math30.stats.correctAnswers }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-danger text-white">
                                    <div class="card-body text-center">
                                        <h5>答错</h5>
                                        <h3>{{ math30.stats.wrongAnswers }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center">
                                        <h5>正确率</h5>
                                        <h3>{{ math30.stats.accuracy }}%</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 历史记录展开区域 -->
                    <div class="history-section mt-5">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4 class="mb-0">
                                <i class="bi bi-clock-history"></i> 答题历史
                            </h4>
                            <div>
                                <button class="btn btn-outline-primary btn-sm me-2"
                                        @click="toggleHistoryExpanded('math30')">
                                    <i class="bi" :class="math30.historyExpanded ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
                                    {{ math30.historyExpanded ? '收起' : '展开' }}详细记录
                                </button>
                                <button class="btn btn-outline-info btn-sm me-2"
                                        @click="resetTodayStats('math30')"
                                        v-if="math30.stats.totalQuestions > 0">
                                    <i class="bi bi-arrow-clockwise"></i> 重置今日
                                </button>
                                <button class="btn btn-outline-warning btn-sm"
                                        @click="clearPracticeHistory('math30')"
                                        v-if="Object.keys(math30.history).length > 0">
                                    <i class="bi bi-trash"></i> 清空全部
                                </button>
                            </div>
                        </div>
                        
                        <!-- 简要统计 -->
                        <div class="history-summary p-3 bg-light rounded">
                            <div class="row text-center">
                                <div class="col-3">
                                    <div class="fw-bold text-primary">{{ Object.keys(math30.history).length }}</div>
                                    <small class="text-muted">累计题目</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-success">{{ math30.allTimeStats.correctAnswers }}</div>
                                    <small class="text-muted">累计答对</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-danger">{{ math30.allTimeStats.wrongAnswers }}</div>
                                    <small class="text-muted">累计答错</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-info">{{ math30.allTimeStats.accuracy }}%</div>
                                    <small class="text-muted">累计正确率</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 详细历史记录 -->
                        <div v-show="math30.historyExpanded" class="history-details mt-3">
                            <div v-if="Object.keys(math30.history).length === 0" class="text-center text-muted py-5">
                                <i class="bi bi-clipboard-x" style="font-size: 3rem;"></i>
                                <h5 class="mt-3">暂无历史记录</h5>
                                <p>开始练习题目后，这里会显示你的答题历史</p>
                            </div>
                            
                            <div v-else class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>题目</th>
                                            <th>正确次数</th>
                                            <th>错误次数</th>
                                            <th>总次数</th>
                                            <th>正确率</th>
                                            <th>最后答题时间</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(record, question) in getSortedHistory('math30')" :key="question">
                                            <td class="fw-bold">{{ question }}</td>
                                            <td class="text-success">{{ record.correct }}</td>
                                            <td class="text-danger">{{ record.wrong }}</td>
                                            <td>{{ record.correct + record.wrong }}</td>
                                            <td>
                                                <span class="badge" :class="getAccuracyBadgeClass(record.correct, record.wrong)">
                                                    {{ Math.round(record.correct / (record.correct + record.wrong) * 100) }}%
                                                </span>
                                            </td>
                                            <td class="text-muted">{{ formatTime(record.lastTime) }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 50以内加减法 -->
                <div class="tab-pane fade" id="math50" role="tabpanel" aria-labelledby="math50-tab">
                    <h3 class="mt-3">50以内加减法训练</h3>
                    
                    <!-- 练习区域 -->
                    <div class="practice-area">
                        <div class="text-center my-4">
                            <div class="question-card">
                                <span v-if="math50.currentQuestion">{{ math50.currentQuestion.text }}</span>
                                <span v-else>准备开始...</span>
                            </div>
                            
                            <div class="mt-4" v-if="math50.currentQuestion && !math50.showingResult">
                                <button v-for="option in math50.currentQuestion.options" :key="option"
                                        class="answer-btn btn btn-light"
                                        :disabled="math50.selectedAnswer !== null"
                                        @click="selectAnswer('math50', option)">
                                    {{ option }}
                                </button>
                            </div>
                            
                            <div class="mt-4" v-if="math50.showingResult">
                                <div v-if="math50.isCorrect" class="text-success">
                                    <i class="bi bi-check-circle-fill result-icon"></i>
                                    <h4>答对了！真棒！</h4>
                                </div>
                                <div v-else class="text-danger">
                                    <i class="bi bi-x-circle-fill result-icon"></i>
                                    <h4>再试试看哦！正确答案是 {{ math50.currentQuestion.answer }}</h4>
                                </div>
                                
                                <button class="btn btn-primary mt-3" @click="nextQuestion('math50')">
                                    下一题 <i class="bi bi-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 统计卡片 -->
                    <div class="stats-section mt-5">
                        <h4 class="mb-3">
                            <i class="bi bi-calendar-day"></i> 今日练习统计
                            <small class="text-muted ms-2">{{ getCurrentDateString() }}</small>
                        </h4>
                        <div class="row">
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center">
                                        <h5>总题数</h5>
                                        <h3>{{ math50.stats.totalQuestions }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center">
                                        <h5>答对</h5>
                                        <h3>{{ math50.stats.correctAnswers }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-danger text-white">
                                    <div class="card-body text-center">
                                        <h5>答错</h5>
                                        <h3>{{ math50.stats.wrongAnswers }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center">
                                        <h5>正确率</h5>
                                        <h3>{{ math50.stats.accuracy }}%</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 历史记录展开区域 -->
                    <div class="history-section mt-5">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4 class="mb-0">
                                <i class="bi bi-clock-history"></i> 答题历史
                            </h4>
                            <div>
                                <button class="btn btn-outline-primary btn-sm me-2"
                                        @click="toggleHistoryExpanded('math50')">
                                    <i class="bi" :class="math50.historyExpanded ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
                                    {{ math50.historyExpanded ? '收起' : '展开' }}详细记录
                                </button>
                                <button class="btn btn-outline-info btn-sm me-2"
                                        @click="resetTodayStats('math50')"
                                        v-if="math50.stats.totalQuestions > 0">
                                    <i class="bi bi-arrow-clockwise"></i> 重置今日
                                </button>
                                <button class="btn btn-outline-warning btn-sm"
                                        @click="clearPracticeHistory('math50')"
                                        v-if="Object.keys(math50.history).length > 0">
                                    <i class="bi bi-trash"></i> 清空全部
                                </button>
                            </div>
                        </div>
                        
                        <!-- 简要统计 -->
                        <div class="history-summary p-3 bg-light rounded">
                            <div class="row text-center">
                                <div class="col-3">
                                    <div class="fw-bold text-primary">{{ Object.keys(math50.history).length }}</div>
                                    <small class="text-muted">累计题目</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-success">{{ math50.allTimeStats.correctAnswers }}</div>
                                    <small class="text-muted">累计答对</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-danger">{{ math50.allTimeStats.wrongAnswers }}</div>
                                    <small class="text-muted">累计答错</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-info">{{ math50.allTimeStats.accuracy }}%</div>
                                    <small class="text-muted">累计正确率</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 详细历史记录 -->
                        <div v-show="math50.historyExpanded" class="history-details mt-3">
                            <div v-if="Object.keys(math50.history).length === 0" class="text-center text-muted py-5">
                                <i class="bi bi-clipboard-x" style="font-size: 3rem;"></i>
                                <h5 class="mt-3">暂无历史记录</h5>
                                <p>开始练习题目后，这里会显示你的答题历史</p>
                            </div>
                            
                            <div v-else class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>题目</th>
                                            <th>正确次数</th>
                                            <th>错误次数</th>
                                            <th>总次数</th>
                                            <th>正确率</th>
                                            <th>最后答题时间</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(record, question) in getSortedHistory('math50')" :key="question">
                                            <td class="fw-bold">{{ question }}</td>
                                            <td class="text-success">{{ record.correct }}</td>
                                            <td class="text-danger">{{ record.wrong }}</td>
                                            <td>{{ record.correct + record.wrong }}</td>
                                            <td>
                                                <span class="badge" :class="getAccuracyBadgeClass(record.correct, record.wrong)">
                                                    {{ Math.round(record.correct / (record.correct + record.wrong) * 100) }}%
                                                </span>
                                            </td>
                                            <td class="text-muted">{{ formatTime(record.lastTime) }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 乘法口诀 -->
                <div class="tab-pane fade" id="multiplication" role="tabpanel" aria-labelledby="multiplication-tab">
                    <h3 class="mt-3">乘法口诀训练</h3>
                    
                    <!-- 乘法表 -->
                    <div class="multiplication-table mt-4">
                        <h4 class="mb-3">乘法口诀表</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>×</th>
                                    <th v-for="i in 9" :key="'header-'+i">{{ i }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="i in 9" :key="'row-'+i">
                                    <th>{{ i }}</th>
                                    <td v-for="j in 9" :key="'cell-'+i+'-'+j"
                                        :class="{ 'highlight': isHighlighted(i, j), 'selected': isSelected(i, j) }"
                                        @click="selectMultiplicationCell(i, j)">
                                        {{ i * j }}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 练习区域 -->
                    <div class="practice-area">
                        <div class="text-center my-4">
                            <div class="question-card">
                                <span v-if="multiplication.currentQuestion">{{ multiplication.currentQuestion.text }}</span>
                                <span v-else>准备开始...</span>
                            </div>
                            
                            <div class="mt-4" v-if="multiplication.currentQuestion && !multiplication.showingResult">
                                <button v-for="option in multiplication.currentQuestion.options" :key="option"
                                        class="answer-btn btn btn-light"
                                        :disabled="multiplication.selectedAnswer !== null"
                                        @click="selectAnswer('multiplication', option)">
                                    {{ option }}
                                </button>
                            </div>
                            
                            <div class="mt-4" v-if="multiplication.showingResult">
                                <div v-if="multiplication.isCorrect" class="text-success">
                                    <i class="bi bi-check-circle-fill result-icon"></i>
                                    <h4>答对了！真棒！</h4>
                                </div>
                                <div v-else class="text-danger">
                                    <i class="bi bi-x-circle-fill result-icon"></i>
                                    <h4>再试试看哦！正确答案是 {{ multiplication.currentQuestion.answer }}</h4>
                                </div>
                                
                                <button class="btn btn-primary mt-3" @click="nextQuestion('multiplication')">
                                    下一题 <i class="bi bi-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 统计卡片 -->
                    <div class="stats-section mt-5">
                        <h4 class="mb-3">
                            <i class="bi bi-calendar-day"></i> 今日练习统计
                            <small class="text-muted ms-2">{{ getCurrentDateString() }}</small>
                        </h4>
                        <div class="row">
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center">
                                        <h5>总题数</h5>
                                        <h3>{{ multiplication.stats.totalQuestions }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center">
                                        <h5>答对</h5>
                                        <h3>{{ multiplication.stats.correctAnswers }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-danger text-white">
                                    <div class="card-body text-center">
                                        <h5>答错</h5>
                                        <h3>{{ multiplication.stats.wrongAnswers }}</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6 mb-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center">
                                        <h5>正确率</h5>
                                        <h3>{{ multiplication.stats.accuracy }}%</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 历史记录展开区域 -->
                    <div class="history-section mt-5">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4 class="mb-0">
                                <i class="bi bi-clock-history"></i> 答题历史
                            </h4>
                            <div>
                                <button class="btn btn-outline-primary btn-sm me-2"
                                        @click="toggleHistoryExpanded('multiplication')">
                                    <i class="bi" :class="multiplication.historyExpanded ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
                                    {{ multiplication.historyExpanded ? '收起' : '展开' }}详细记录
                                </button>
                                <button class="btn btn-outline-info btn-sm me-2"
                                        @click="resetTodayStats('multiplication')"
                                        v-if="multiplication.stats.totalQuestions > 0">
                                    <i class="bi bi-arrow-clockwise"></i> 重置今日
                                </button>
                                <button class="btn btn-outline-warning btn-sm"
                                        @click="clearPracticeHistory('multiplication')"
                                        v-if="Object.keys(multiplication.history).length > 0">
                                    <i class="bi bi-trash"></i> 清空全部
                                </button>
                            </div>
                        </div>
                        
                        <!-- 简要统计 -->
                        <div class="history-summary p-3 bg-light rounded">
                            <div class="row text-center">
                                <div class="col-3">
                                    <div class="fw-bold text-primary">{{ Object.keys(multiplication.history).length }}</div>
                                    <small class="text-muted">累计题目</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-success">{{ multiplication.allTimeStats.correctAnswers }}</div>
                                    <small class="text-muted">累计答对</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-danger">{{ multiplication.allTimeStats.wrongAnswers }}</div>
                                    <small class="text-muted">累计答错</small>
                                </div>
                                <div class="col-3">
                                    <div class="fw-bold text-info">{{ multiplication.allTimeStats.accuracy }}%</div>
                                    <small class="text-muted">累计正确率</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 详细历史记录 -->
                        <div v-show="multiplication.historyExpanded" class="history-details mt-3">
                            <div v-if="Object.keys(multiplication.history).length === 0" class="text-center text-muted py-5">
                                <i class="bi bi-clipboard-x" style="font-size: 3rem;"></i>
                                <h5 class="mt-3">暂无历史记录</h5>
                                <p>开始练习题目后，这里会显示你的答题历史</p>
                            </div>
                            
                            <div v-else class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead class="table-dark">
                                        <tr>
                                            <th>题目</th>
                                            <th>正确次数</th>
                                            <th>错误次数</th>
                                            <th>总次数</th>
                                            <th>正确率</th>
                                            <th>最后答题时间</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(record, question) in getSortedHistory('multiplication')" :key="question">
                                            <td class="fw-bold">{{ question }}</td>
                                            <td class="text-success">{{ record.correct }}</td>
                                            <td class="text-danger">{{ record.wrong }}</td>
                                            <td>{{ record.correct + record.wrong }}</td>
                                            <td>
                                                <span class="badge" :class="getAccuracyBadgeClass(record.correct, record.wrong)">
                                                    {{ Math.round(record.correct / (record.correct + record.wrong) * 100) }}%
                                                </span>
                                            </td>
                                            <td class="text-muted">{{ formatTime(record.lastTime) }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <a href="index.html" class="btn btn-outline-secondary">
                    <i class="bi bi-house-door"></i> 返回首页
                </a>
            </div>
        </div>
    </div>
    
    <!-- 引入Bootstrap和Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.min.js"></script>
    
    <script>
        // 创建Vue应用
        const app = Vue.createApp({
            data() {
                return {
                    activeTab: 'math30',
                    // 30以内加减法
                    math30: {
                        currentQuestion: null,
                        selectedAnswer: null,
                        isCorrect: false,
                        showingResult: false,
                        historyExpanded: false,
                        history: {},
                        stats: {
                            totalQuestions: 0,
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        },
                        allTimeStats: {
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        }
                    },
                    // 50以内加减法
                    math50: {
                        currentQuestion: null,
                        selectedAnswer: null,
                        isCorrect: false,
                        showingResult: false,
                        historyExpanded: false,
                        history: {},
                        stats: {
                            totalQuestions: 0,
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        },
                        allTimeStats: {
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        }
                    },
                    // 乘法口诀
                    multiplication: {
                        currentQuestion: null,
                        selectedAnswer: null,
                        isCorrect: false,
                        showingResult: false,
                        historyExpanded: false,
                        highlightedRow: null,
                        highlightedCol: null,
                        selectedCell: null,
                        history: {},
                        stats: {
                            totalQuestions: 0,
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        },
                        allTimeStats: {
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        }
                    }
                };
            },
            mounted() {
                // 加载本地存储的历史记录
                this.loadHistoryFromLocalStorage();
                
                // 初始化各模块的问题
                this.generateQuestion('math30');
                this.generateQuestion('math50');
                this.generateQuestion('multiplication');
                
                // 计算所有时间的统计数据
                this.calculateAllTimeStats('math30');
                this.calculateAllTimeStats('math50');
                this.calculateAllTimeStats('multiplication');
            },
            methods: {
                // 生成问题
                generateQuestion(module) {
                    let question, a, b, answer, options;
                    
                    if (module === 'math30') {
                        // 30以内加减法
                        const isAddition = Math.random() > 0.5;
                        
                        if (isAddition) {
                            // 加法题目
                            a = Math.floor(Math.random() * 20) + 1;
                            b = Math.floor(Math.random() * (30 - a)) + 1;
                            answer = a + b;
                            question = `${a} + ${b} = ?`;
                        } else {
                            // 减法题目
                            a = Math.floor(Math.random() * 20) + 10; // 10-30之间的数
                            b = Math.floor(Math.random() * a) + 1; // 确保b小于a
                            answer = a - b;
                            question = `${a} - ${b} = ?`;
                        }
                        
                        // 生成选项（包括正确答案）
                        options = this.generateOptions(answer, 0, 30);
                    } else if (module === 'math50') {
                        // 50以内加减法
                        const isAddition = Math.random() > 0.5;
                        
                        if (isAddition) {
                            // 加法题目
                            a = Math.floor(Math.random() * 30) + 1;
                            b = Math.floor(Math.random() * (50 - a)) + 1;
                            answer = a + b;
                            question = `${a} + ${b} = ?`;
                        } else {
                            // 减法题目
                            a = Math.floor(Math.random() * 30) + 20; // 20-50之间的数
                            b = Math.floor(Math.random() * a) + 1; // 确保b小于a
                            answer = a - b;
                            question = `${a} - ${b} = ?`;
                        }
                        
                        // 生成选项（包括正确答案）
                        options = this.generateOptions(answer, 0, 50);
                    } else if (module === 'multiplication') {
                        // 乘法口诀
                        a = Math.floor(Math.random() * 9) + 1; // 1-9
                        b = Math.floor(Math.random() * 9) + 1; // 1-9
                        answer = a * b;
                        question = `${a} × ${b} = ?`;
                        
                        // 生成选项（包括正确答案）
                        options = this.generateOptions(answer, 1, 81);
                    }
                    
                    this[module].currentQuestion = {
                        text: question,
                        a: a,
                        b: b,
                        answer: answer,
                        options: options
                    };
                    
                    this[module].selectedAnswer = null;
                    this[module].showingResult = false;
                    
                    // 如果是乘法，高亮对应的行和列
                    if (module === 'multiplication') {
                        this.multiplication.highlightedRow = a;
                        this.multiplication.highlightedCol = b;
                        this.multiplication.selectedCell = null;
                    }
                },
                
                // 生成选项
                generateOptions(correctAnswer, min, max) {
                    const options = [correctAnswer];
                    
                    // 生成3个不重复的错误选项
                    while (options.length < 4) {
                        const option = Math.floor(Math.random() * (max - min + 1)) + min;
                        
                        // 确保选项不重复且在合理范围内
                        if (!options.includes(option) && option >= 0) {
                            options.push(option);
                        }
                    }
                    
                    // 打乱选项顺序
                    return options.sort(() => Math.random() - 0.5);
                },
                
                // 选择答案
                selectAnswer(module, answer) {
                    this[module].selectedAnswer = answer;
                    this[module].isCorrect = answer === this[module].currentQuestion.answer;
                    this[module].showingResult = true;
                    
                    // 更新统计数据
                    this[module].stats.totalQuestions++;
                    
                    if (this[module].isCorrect) {
                        this[module].stats.correctAnswers++;
                    } else {
                        this[module].stats.wrongAnswers++;
                    }
                    
                    // 计算正确率
                    this[module].stats.accuracy = Math.round(
                        (this[module].stats.correctAnswers / this[module].stats.totalQuestions) * 100
                    );
                    
                    // 更新历史记录
                    this.updateHistory(module);
                    
                    // 如果是乘法，选中对应的单元格
                    if (module === 'multiplication') {
                        if (this[module].isCorrect) {
                            this.multiplication.selectedCell = {
                                row: this[module].currentQuestion.a,
                                col: this[module].currentQuestion.b
                            };
                        }
                    }
                    
                    // 保存到本地存储
                    this.saveHistoryToLocalStorage();
                    
                    // 延迟1.5秒后自动进入下一题
                    setTimeout(() => {
                        this.nextQuestion(module);
                    }, 1500);
                },
                
                // 下一题
                nextQuestion(module) {
                    this.generateQuestion(module);
                },
                
                // 更新历史记录
                updateHistory(module) {
                    const question = this[module].currentQuestion.text;
                    const isCorrect = this[module].isCorrect;
                    
                    if (!this[module].history[question]) {
                        this[module].history[question] = {
                            correct: 0,
                            wrong: 0,
                            lastTime: new Date().getTime()
                        };
                    }
                    
                    if (isCorrect) {
                        this[module].history[question].correct++;
                    } else {
                        this[module].history[question].wrong++;
                    }
                    
                    this[module].history[question].lastTime = new Date().getTime();
                    
                    // 计算所有时间的统计数据
                    this.calculateAllTimeStats(module);
                },
                
                // 计算所有时间的统计数据
                calculateAllTimeStats(module) {
                    let totalCorrect = 0;
                    let totalWrong = 0;
                    
                    for (const question in this[module].history) {
                        totalCorrect += this[module].history[question].correct;
                        totalWrong += this[module].history[question].wrong;
                    }
                    
                    this[module].allTimeStats.correctAnswers = totalCorrect;
                    this[module].allTimeStats.wrongAnswers = totalWrong;
                    
                    const total = totalCorrect + totalWrong;
                    this[module].allTimeStats.accuracy = total > 0 ? Math.round((totalCorrect / total) * 100) : 0;
                },
                
                // 获取排序后的历史记录
                getSortedHistory(module) {
                    const history = this[module].history;
                    const sortedQuestions = Object.keys(history).sort((a, b) => {
                        return history[b].lastTime - history[a].lastTime;
                    });
                    
                    const sortedHistory = {};
                    sortedQuestions.forEach(question => {
                        sortedHistory[question] = history[question];
                    });
                    
                    return sortedHistory;
                },
                
                // 切换历史记录展开状态
                toggleHistoryExpanded(module) {
                    this[module].historyExpanded = !this[module].historyExpanded;
                },
                
                // 重置今日统计
                resetTodayStats(module) {
                    if (confirm('确定要重置今日统计数据吗？')) {
                        this[module].stats = {
                            totalQuestions: 0,
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        };
                    }
                },
                
                // 清空练习历史
                clearPracticeHistory(module) {
                    if (confirm('确定要清空所有历史记录吗？此操作不可恢复！')) {
                        this[module].history = {};
                        this[module].stats = {
                            totalQuestions: 0,
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        };
                        this[module].allTimeStats = {
                            correctAnswers: 0,
                            wrongAnswers: 0,
                            accuracy: 0
                        };
                        
                        // 保存到本地存储
                        this.saveHistoryToLocalStorage();
                    }
                },
                
                // 保存历史记录到本地存储
                saveHistoryToLocalStorage() {
                    localStorage.setItem('math30History', JSON.stringify(this.math30.history));
                    localStorage.setItem('math30Stats', JSON.stringify(this.math30.stats));
                    
                    localStorage.setItem('math50History', JSON.stringify(this.math50.history));
                    localStorage.setItem('math50Stats', JSON.stringify(this.math50.stats));
                    
                    localStorage.setItem('multiplicationHistory', JSON.stringify(this.multiplication.history));
                    localStorage.setItem('multiplicationStats', JSON.stringify(this.multiplication.stats));
                },
                
                // 从本地存储加载历史记录
                loadHistoryFromLocalStorage() {
                    // 30以内加减法
                    const math30History = localStorage.getItem('math30History');
                    const math30Stats = localStorage.getItem('math30Stats');
                    
                    if (math30History) {
                        this.math30.history = JSON.parse(math30History);
                    }
                    
                    if (math30Stats) {
                        this.math30.stats = JSON.parse(math30Stats);
                    }
                    
                    // 50以内加减法
                    const math50History = localStorage.getItem('math50History');
                    const math50Stats = localStorage.getItem('math50Stats');
                    
                    if (math50History) {
                        this.math50.history = JSON.parse(math50History);
                    }
                    
                    if (math50Stats) {
                        this.math50.stats = JSON.parse(math50Stats);
                    }
                    
                    // 乘法口诀
                    const multiplicationHistory = localStorage.getItem('multiplicationHistory');
                    const multiplicationStats = localStorage.getItem('multiplicationStats');
                    
                    if (multiplicationHistory) {
                        this.multiplication.history = JSON.parse(multiplicationHistory);
                    }
                    
                    if (multiplicationStats) {
                        this.multiplication.stats = JSON.parse(multiplicationStats);
                    }
                },
                
                // 获取当前日期字符串
                getCurrentDateString() {
                    const now = new Date();
                    return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;
                },
                
                // 格式化时间
                formatTime(timestamp) {
                    const date = new Date(timestamp);
                    return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
                },
                
                // 获取正确率徽章样式
                getAccuracyBadgeClass(correct, wrong) {
                    const total = correct + wrong;
                    const accuracy = Math.round((correct / total) * 100);
                    
                    if (accuracy >= 80) {
                        return 'bg-success';
                    } else if (accuracy >= 60) {
                        return 'bg-warning text-dark';
                    } else {
                        return 'bg-danger';
                    }
                },
                
                // 乘法表相关方法
                isHighlighted(row, col) {
                    return (this.multiplication.highlightedRow === row || this.multiplication.highlightedCol === col) && !this.isSelected(row, col);
                },
                
                isSelected(row, col) {
                    return this.multiplication.selectedCell && 
                           this.multiplication.selectedCell.row === row && 
                           this.multiplication.selectedCell.col === col;
                },
                
                selectMultiplicationCell(row, col) {
                    // 如果当前有问题且未显示结果，则选择该单元格作为答案
                    if (this.multiplication.currentQuestion && !this.multiplication.showingResult) {
                        const answer = row * col;
                        this.selectAnswer('multiplication', answer);
                    }
                }
            }
        });
        
        // 挂载Vue应用
        app.mount('#app');
    </script>
</body>
</html>